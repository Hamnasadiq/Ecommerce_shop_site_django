<!-- <!DOCTYPE html>
<html>

<head>

<title>Shop</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>

<script src="https://code.jquery.com/jquery-3.7.1.js"></script>

<link rel="stylesheet" href="{% static 'shop/style.css' %}">

<style>

.product-card{

display:flex;

flex-direction:column;

height:100%;

box-shadow:0 2px 8px rgba(0,0,0,.1);

transition:.2s;

}

.product-card:hover{

transform:scale(1.02);

}

.product-card img{

height:200px;

object-fit:cover;

}

.sidebar a{

text-decoration:none;

color:black;

}

.sidebar a:hover{

color:green;

}


.accordion-button{

font-weight:600;

}


.accordion-button:not(.collapsed){

background:#f8f9fa;

}

</style>

</head>


<body>

<div class="container py-3">





<!-- SEARCH -->

<form class="card mb-4">

<div class="card-body row">

<div class="col">

<input

type="search"

name="item_name"

placeholder="Search"

class="form-control">

</div>

<div class="col-auto">

<button

class="btn btn-success">

Search

</button>

</div>

</div>

</form>



<div class="row">

<!-- ================= SIDEBAR ================= -->

<div class="col-md-3 sidebar">


<div class="accordion"

id="categoryAccordion">


<!-- ALL -->

<div class="accordion-item">

<h2>

<a href="/"

class="accordion-button collapsed">

All Products

</a>

</h2>

</div>



{% for category in categories %}

<div class="accordion-item">

<h2 class="accordion-header">

<button

class="accordion-button collapsed"

data-bs-toggle="collapse"

data-bs-target="#cat{{category.id}}">

{{category.name}}

</button>

</h2>


<div

id="cat{{category.id}}"

class="accordion-collapse collapse"

data-bs-parent="#categoryAccordion">


<div class="accordion-body p-2">

<ul class="list-group list-group-flush">


{% for sub in category.subcategories.all %}

<li class="list-group-item border-0 p-1">

<a

href="?subcategory={{sub.id}}">

{{sub.name}}

</a>

</li>

{% endfor %}


</ul>

</div>

</div>

</div>

{% endfor %}

</div>

</div>



<!-- ================= PRODUCTS ================= -->

<div class="col-md-9">

<div class="row g-4">


{% for product in product_objects %}

<div class="col-md-4 d-flex">


<div class="card product-card w-100">

{% if product.image %}

<img src="{{product.image.url}}">

{% elif product.image_url %}

<img src="{{product.image_url}}">

{% endif %}



<div class="card-body">

<h5 id="nm{{product.id}}">

{{product.title}}

</h5>

<p id="price{{product.id}}">

$ {{product.price}}

</p>


<div class="d-flex justify-content-between">

<a

href="/{{product.id}}"

class="btn btn-warning">

View

</a>


<button

id="{{product.id}}"

class="btn atc btn-warning">

Add to cart

</button>

</div>

</div>

</div>

</div>

{% endfor %}

</div>



<!-- PAGINATION -->

<div class="mt-4">

<ul class="pagination">


{% if product_objects.has_previous %}

<li class="page-item">

<a

class="page-link"

href="?page={{product_objects.previous_page_number}}">

Previous

</a>

</li>

{% endif %}


<li class="page-item active">

<a class="page-link">

{{product_objects.number}}

</a>

</li>


{% if product_objects.has_next %}

<li class="page-item">

<a

class="page-link"

href="?page={{product_objects.next_page_number}}">

Next

</a>

</li>

{% endif %}

</ul>

</div>

</div>

</div>

</div>


<script>

let cart=localStorage.getItem('cart')

?JSON.parse(localStorage.getItem('cart'))

:{};


function generateCartHTML(cart){

let s="<h5>Your Cart</h5>";

let i=1;

for(let x in cart){

s+=`${i}. ${cart[x][1]} Qty:${cart[x][0]}<br>`;

i++;

}

return s;

}



document.addEventListener('DOMContentLoaded',function(){

new bootstrap.Popover(

document.getElementById('cart'),

{

html:true,

content:generateCartHTML(cart)

});

document.getElementById("cart")

.innerHTML="Cart("+Object.keys(cart).length+")";

});



$(document).on('click','.atc',function(){

let id=this.id;

let name=document.getElementById("nm"+id).innerText;

let price=parseFloat(

document.getElementById("price"+id)

.innerText.replace('$','')

);

if(cart[id]){

cart[id][0]+=1;

}

else{

cart[id]=[1,name,price];

}

localStorage.setItem(

'cart',

JSON.stringify(cart)

);

document.getElementById("cart")

.innerHTML="Cart("+Object.keys(cart).length+")";

});

</script>

</body>

</html> -->